---
title: An R Markdown document converted from "DACES_601_HW_1 (2).ipynb"
output: html_document
---

# Start Fresh

code for starting fresh?

```{r}
# Remove all objects from the current R environment
# This ensures a clean workspace before running any analysis
rm(list = ls())
```

# get the data

code for opening a file from a url (File in excel), Name it fragility23?


```{r}
#Checks whether the 'rio' package is already installed if the package is not installed, install it from CRAN
if (!require("rio")) {
  install.packages("rio")
}
library(rio) #Loads the RIO package, which allows for importing excel easily

# Define the URL of the Excel file
url <- "https://github.com/DACSS-Fundamentals/overview/raw/refs/heads/main/FSI-2023-DOWNLOAD.xlsx"

# Import the Excel file into a data frame named fragility23
fragility23 <- import(url) #Stores the resulting data frame in an object called fragility23
```

# exploratory commands

find out column names in fragility23?

```{r}
# Display the column names of the dataset
names(fragility23) #This helps identify available variables
```

check the data types in df?

```{r}
# Check the structure of the dataset
# This shows variable types (numeric, character, etc.)
str(fragility23)
```

show me the first 10 rows?

```{r}
# Display the first 10 rows of the dataset
#This provides an initial look at the data values
head(fragility23, 10) 
```

show me the last 10 rows?

```{r}
# Display the last 10 rows of the dataset
#This helps verify how the dataset ends
tail(fragility23, 10)
```

# transformative commands

### subsetting

keep some columns: Country, Total, S1: Demographic Pressures, P1: State Legitimacy, E2: Economic Inequality into object frag23_sub

```{r}
# Identify columns that contain the variables of interest
# Country, Total, S1 (Demographic Pressures),
# P1 (State Legitimacy), E2 (Economic Inequality)
keep <- grep(
  pattern = "Country|S1|P1|E2|Total",
  x = names(fragility23),
  value = TRUE
)

# Subset the dataset to keep only selected columns
#store the resulting data frame in frag23_sub
frag23_sub <- fragility23[, keep]
```

### renaming

rename frag23_sub columns, keep var codes only

```{r}
# Rename the indicator columns using short variable codes
#This helps with readability and consistency
names(frag23_sub)[3:5] <- c("S1", "E2", "P1")
```

### filtering

get me the top ten best countries on the “E2” measure from frag23_sub.

```{r}
# Get the top ten countries with the best (highest) E2 values
#Sort the dataset by E2 values in descending order, selects the top ten rows after sorting
top10_E2 <- tail(
  frag23_sub[order(-frag23_sub$E2), ],
  10
)

# Display only the country names of the top ten
top10_E2$Country
```

# some computations

give the statistical description of frag23_sub

```{r}
# Display summary statistics such as mean, median, and quartiles for all variables in frag23_sub
summary(frag23_sub)
```

the value of the worst quartile in Total

```{r}
# Calculate the value of the worst quartile (75th percentile)
# of the Total Fragility score
q3_Total <- quantile(
  x = frag23_sub$Total,
  probs = 0.75,
  na.rm = TRUE
)

# Display the quartile value
q3_Total
```

show correlations between “S1”, “E2”, “P1”

```{r}
# Show correlations between S1, E2, and P1
# Country and Total are excluded
cor(frag23_sub[, -c(1, 2)], use = "complete.obs")

```

regress P1 and E2 on S1.

```{r}
# Fit a linear regression model with S1 as the dependent variable P1 and E2 are included as independent variables
model <- lm(S1 ~ P1 + E2, data = frag23_sub)

# Display a detailed summary of the regression results
summary(model)
```

# Some Plotting

give me a plot for the “P1” variable

```{r}
# create a histogram of the P1 Variable, This visualizes the distribution of state legitimacy scores
# Plot a histogram of the P1 variable
hist(
  x = frag23_sub$P1,
  main = "Histogram of State Legitimacy (P1)",
  xlab = "P1 Score"
)
```

visual correlation between S1 and E2

```{r}
#Create a scatter plot of S1 versus E2, This helps visualize the relationship between the two variables
plot(
  x = frag23_sub$S1,
  y = frag23_sub$E2,
  xlab = "Demographic Pressures (S1)",
  ylab = "Economic Inequality (E2)",
  main = "S1 vs E2"
)
```

visual of the regression P1 and E2 on S1

```{r}
# Creates a logical variable indicating worst quartile belongs to the worst quartile of Total fragility
frag23_sub$worstQt <- frag23_sub$Total >= q3_Total

# Creates a scatter plot of S1 versus E2 points are colored based on worst quartile membership
plot(
  frag23_sub$S1,
  frag23_sub$E2,
  pch = 20,
  col = as.factor(frag23_sub$worstQt),
  xlab = "Demographic Pressures (S1)",
  ylab = "Economic Inequality (E2)",
  main = "S1 vs E2 (Worst Quartile Highlighted)"
)


# Scatter plot of S1 vs P1
plot(frag23_sub$P1, frag23_sub$S1,
     xlab = "State Legitimacy (P1)",
     ylab = "Demographic Pressures (S1)",
     main = "Regression of S1 on P1")

# Add regression line
abline(lm(S1 ~ P1, data = frag23_sub), col = "blue")

# Scatter plot of S1 vs E2
plot(frag23_sub$E2, frag23_sub$S1,
     xlab = "Economic Inequality (E2)",
     ylab = "Demographic Pressures (S1)",
     main = "Regression of S1 on E2")

# Add the fitted regression line to the plot
abline(lm(S1 ~ E2, data = frag23_sub), col = "red")
```

